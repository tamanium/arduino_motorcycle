# バイク用自作マルチディスプレイ
## タスク
* 回路図作成
* 12->5Vレギュレーター検討・発掘
    * アリエクでto USB-A用レギュレーターモジュールを購入してた
* レベルシフタ用途のMOSFET検討・発掘
* 操作用スイッチ検討・発掘
    * プッシュスイッチorトグルスイッチ 
        * 明るさ切り替えだけならトグルでも可
* スイッチの用途検討
    * 明るさ調整
    * スイッチ場所
        * 明るさだけなら本体直付けでも可
        * 走行中の操作があれば手元付近 
    * 表示切り替え
        * 切り替えるほど内容が無いのでこれは無しか


## 対象バイク
クロスカブ JA60
```:回路図

Housing side                                        ││　Inner side
                                                    ││                                       12V 
       VCC                  VCC              VCC    ││                                        │
        │                    │                │     ││                                     ┌──┴──┐
┌───────┴───────┐     ┌──────┴──────┐         └─────││────────┬────────┬──────────┬────────┤ reg │
│           MOSI├─────┤3          14├─SDA───────────││───────┐│───────┐│─────────┐│        └──┬──┘
│           SCLK├─────┤2          15├─SCL───────────││──────┐││──────┐││────────┐││           │
│    Display  BL├─────┤5  RP2040    │         ┌─────││─────┐│││─────┐│││───────┐│││───────────┘
│             CS├─────┤6          27├────┐    │     ││     ││││     ││││       ││││          
│             DC├─────┤7            │ ┌──┴──┐ │     ││   ┌─┴┴┴┴─┐ ┌─┴┴┴┴─┐ ┌───┴┴┴┴────┐
│            RST├─────┤8            │ │ bzz │ │     ││   │DS1307│ │ LM75 │ │ PCF8574T 0├─Left───
└───────┬───────┘     └──────┬──────┘ └──┬──┘ │     ││   │ board│ │ board│ │          1├─Right──
        │                    │           │    │     ││   └──────┘ └──────┘ │          2├─N──────
       GND                  GND         GND  GND    ││                     │          7├─1──────
                                                                           │          6├─2──────
                                                                           │          5├─3──────
                                                                           │          4├─4──────
                                                                           └───────────┘

```
## 表示項目一覧
|機能|備考
|---|---|
|速度計|~~GPSで算出~~<br>検討中
|時計|RTCモジュール使用
|温度計|~~K型熱電対モジュール使用~~<br>~~MCP9700~~<br>LM75Aボード
|ギアポジ|IOエキスパンダ経由で状態取得
|ウインカー|IOエキスパンダ経由で状態取得
|ウインカー音|ウインカー状態切替時に発音
|バッテリー電圧|なにかしらのアナログ入力<br>マイコンをI2Cモジュール化してアナログ入力か<br>優先度低

## モジュール一覧
|機能|モジュール
|---|---|
|ディスプレイ|ST7789 2.0" 240*320
|マイコン|Waveshare RP2040-Zero
|レギュレータ(12 to 5V)| 検討中
|IOエキスパンダ|PCF8574T
|ブザー|4216A
|時計|TinyRTC(DS1307)
|温度計|~~MAX6675~~<br>LM75Aボード

## 各種機能の進捗
### ギアポジション認識・ウインカー認識
* ~~マイコンのピン~~
    * ~~読取...OK~~
    * ~~表示...OK~~
        * ケーブルが多くなるため別手段検討
* IOエキスパンダー(PCF8574T)
    * 接続...OK
    * 入出力...OK
        * P0...ウインカー右
        * P1...ウインカー左
        * P2...ポジションN
        * P3...未使用(通常利用不可)
        * P4...ポジション1
        * P5...ポジション2
        * P6...ポジション3
        * P7...ポジション4
>> アナログ入力非対応
### ウインカー音
* ブザー(continurous)
    * 接続(IOピン-GND)...OK
    * 発音...OK
        * 音が理想より高め
        * パッケージそのままだと大きすぎるかも
### 時計
* Tiny RTC
    * 接続...OK(I2C)
    * 読取...OK
    * 表示...OK
    * 外部電源無しでの稼働... OK
### 温度計
* ~~MAX6675~~
    * ~~接続...OK(SPI1)~~
    * ~~読取...OK~~
    * ~~表示...OK~~
        * データが怪しいので別手段検討
* LM75Aボード
    * 接続...OK(I2C)
    * 読取...OK
    * 表示...着手中
## その他使用部品
* ケース
    * GoPro13対応防水ハウジング
        * Wide:<75mm
        * Height:<54mm
        * Depth:<28mm
   
